<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Manage {{getSelectedOrganization().name}}</h3>
  </div>

  <div class="panel-body">

    <alerts seconds="45" channels="organization/update, organization/delete" types="SUCCESS, INVALID"></alerts>

    <form ng-submit="updateOrganization(getSelectedOrganization())" name="forms.update" novalidate>

      <validationmessage results="getSelectedOrganization().getValidationResults()"></validationmessage>

      <div class="col-md-12">
        <div class="row">
          <div class="col-xs-6">
            <div class="form-group" ng-if="!canManageOrganization()">
              <div>
                <label ng-if="label" for="name-input">Name</label>
                <input class="form-control" type="text" readonly value="{{getSelectedOrganization().name}}" />
              </div>
            </div>

            <validatedinput
              ng-if="canManageOrganization()"
              no-id="true"
              label="Name"
              model="getSelectedOrganization()"
              property="name"
              placeholder="Name of the organization"
              form="forms.update"
              validations="getSelectedOrganization().getValidations()"
              results="getSelectedOrganization().getValidationResults()">
            </validatedinput>

            <div class="form-group" ng-if="!canManageOrganization()">
              <div>
                <label ng-if="label" for="category-input">Category</label>
                <input class="form-control" type="text" readonly value="{{getSelectedOrganization().category.name}}" />
              </div>
            </div>

            <validatedselect
              ng-if="canManageOrganization()"
              no-id="true"
              label="Category"
              options="organizationCategories"
              optionproperty="name"
              model="getSelectedOrganization()"
              property="category"
              form="forms.update"
              validations="getSelectedOrganization().getValidations()"
              results="getSelectedOrganization().getValidationResults()">
            </validatedselect>

            <div class="form-group" ng-if="!canManageOrganization()">
              <div class="col-sm-6">
                <span class="toggle-button-heading">Organization accepts Submissions?</span>
              </div>
              <div class="col-sm-2">
                <input type="text" readonly class="form-control" value="{{organizationRepo.getSelectedOrganization().acceptsSubmissions ? acceptsSubmissions[0]['true']:acceptsSubmissions[1]['false']}}"/>
              </div>
            </div>

            <toggleButton
              ng-if="canManageOrganization()"
              label="Organization accepts Submissions?"
              scope-value="organizationRepo.getSelectedOrganization().acceptsSubmissions"
              toggle-options="{{acceptsSubmissions}}">
            </toggleButton>

          </div>

          <div class="col-xs-6">

            <div class="form-group" ng-if="!canManageOrganization()">
              <div>
                <label ng-if="label" for="emails-input">Email Contact</label>
                <div class="validated-input-repeatable" ng-repeat="email in getSelectedOrganization().emails">
                  <input class="form-control" type="text" readonly value="{{email}}" />
                </div>
              </div>
            </div>

            <validatedinput
              ng-if="canManageOrganization()"
              no-id="true"
              label="Email Contact"
              model="getSelectedOrganization()"
              property="emails"
              placeholder="Email Address"
              form="forms.update"
              validations="getSelectedOrganization().getValidations()"
              results="getSelectedOrganization().getValidationResults()"
              repeatable="true">
            </validatedinput>

          </div>
        </div>

        <hr />

        <div class="row">
          <div class="pull-right">
            <span uib-popover="This organization contains submissions and cannot be deleted." popover-trigger="'mouseenter'" popover-enable="deleteDisabled">
              <button
                ng-if="!isPrimaryOrganization()"
                type="button"
                class="btn btn-danger"
                ng-style="{'pointer-events':deleteDisabled ? 'none' : ''}"
                ng-disabled="deleteDisabled"
                ng-click="openModal('#organizationConfirmDeleteModal')">Delete Organization</button>
            </span>
            <button
              type="button"
              class="btn btn-default"
              ng-click="resetManageOrganization()"
              ng-disabled="!canManageOrganization() || updatingOrganization">Cancel</button>
            <button
              type="submit"
              class="btn btn-primary"
              ng-disabled="!canManageOrganization() || forms.update.$invalid || updatingOrganization">Save
              <span ng-if="updatingOrganization" class="glyphicon glyphicon-refresh spinning"></span>
            </button>
          </div>
        </div>

      </div>

    </form>

    <modal modal-id="organizationConfirmDeleteModal"
      modal-view="views/modals/organization/organizationConfirmDeleteModal.html"
      modal-header-class="modal-header-danger"
      wvr-modal-backdrop="static">
    </modal>

  </div>

</div>
